phase: build_scenes

inputs:
  - plan_json: project_dir/plan.json
  - narration_script: project_dir/narration_script.py
  - scene_metadata: state.scenes[state.current_scene_index]
  - scene_narration: SCRIPT[narration_key]
  - retry_context: optional
  - references: manim_template, manim_config_guide, visual_helpers
  - exclude: full_pipeline_doc, unrelated_scene_code

output:
  format: json_object
  payload:
    scene_body: "<python_scene_body_only>"
  required_fields:
    - scene_body

validation:
  python_syntax_valid: true
  required_imports_present: true
  no_external_tts: true
  no_external_assets: true
  scene_id_matches_state: true
